"use strict";function getAccordions(){return Array.from(document.querySelectorAll(".fr-accordion"))}function getAccordionItems(e){return Array.from(e.children).filter((function(e){return e.classList.contains("fr-accordion__item")}))}function getAccordionHeader(e){var t=e.querySelector(".fr-accordion__header");if(!t){var n=new Error("Accordion item have a missing Header (.fr-accordion__header)",e);throw n.item=e,n}return t}function getAccordionBody(e){var t=e.querySelector(".fr-accordion__body");if(!t){var n=new Error("Accordion item have a missing Body (.fr-accordion__body)",e);throw n.item=e,n}return t}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey(i.key),i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var accordionInstances=new WeakMap,Accordion=function(){return _createClass((function e(t,n){_classCallCheck(this,e),this.element=t,this.options=n,this.isScrolling=!1,this.scrollTimeout=null,this.initialHashHandled=!1,this.validateStructure()&&(this.removePlaceholder(),this.removePlaceholderChild(),this.accordionItems=getAccordionItems(this.element),this.lastOpenedItem=null,this.init(),accordionInstances.set(this.element,this),this.options.scrollToHash&&location.hash&&this.handleInitialHash())}),[{key:"init",value:function(){var e=this;this.setEventListeners(),this.handleFirstItemOpened(),this.handleAllItemsExpanded(),this.handleExpandedClass(),this.handleScrollToHash(),this.handleShowDuration(),this.addTabindex(),this.addIdToBody(),this.addAriaControls(),this.addIdToHeader(),this.addAriaLabelledBy(),this.addFaqSchema(),this.addRoleButton(),this.ITEMS((function(t){"true"!==e.HEADER(t).getAttribute("aria-expanded")&&e.updateFocusableTabIndex(t,!1)})),this.ITEMS((function(t){var n=e.options.expandedCurrentLink;e.hasCurrentPageLink(t)&&!1===n&&e.expandItem(t)}))}},{key:"BODY",value:function(e){return getAccordionBody(e)}},{key:"HEADER",value:function(e){return getAccordionHeader(e)}},{key:"ITEMS",value:function(e){this.accordionItems.forEach((function(t){"STYLE"===t.tagName||t.classList.contains("brx-nestable-children-placeholder")||"DIV"===t.tagName&&t.classList.contains("brx-query-trail")||e(t)}))}},{key:"removePlaceholder",value:function(){var e=this.element.querySelector(".brx-nestable-children-placeholder"),t=this.element.querySelectorAll(".fr-accordion__item");if(e&&e.remove(),0===t.length){var n=document.createElement("li");n.className="brx-nestable-children-placeholder fr-accordion__item",this.element.appendChild(n)}}},{key:"setEventListeners",value:function(){var e=this;this.ITEMS((function(t){return e.attachHeaderListeners(t)}))}},{key:"attachHeaderListeners",value:function(e){var t=this,n=this.HEADER(e);n.addEventListener("click",(function(){t.headerInteraction(e)})),n.addEventListener("keydown",(function(n){"Enter"===n.key&&t.headerInteraction(e)})),n.addEventListener("keyup",(function(n){" "===n.key&&t.headerInteraction(e)}))}},{key:"generateUniqueId",value:function(e){this.usedIds||(this.usedIds=new Set);var t=this.HEADER(e);if(t.id)return this.usedIds.add(t.id),t.id;var n=t.querySelector(".fr-accordion__title");if(n){var i=n.textContent.trim().split(" ").slice(0,3).join("-").toLowerCase().replace(/[^a-z0-9-]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");if(this.usedIds.has(i)){for(var o=2,r="".concat(i,"-").concat(o);this.usedIds.has(r);)o++,r="".concat(i,"-").concat(o);i=r}return this.usedIds.add(i),i}var a="accordion-item-".concat(Math.random().toString(36).substr(2,9));return this.usedIds.add(a),a}},{key:"headerInteraction",value:function(e){var t=this;window.innerWidth<=this.options.scrollToHeadingOn&&this.scrollToItemHeader(e),this.options.closePreviousItem&&this.options.allItemsExpanded?this.ITEMS((function(n){n!==e&&t.collapseItem(n)})):this.options.closePreviousItem&&this.lastOpenedItem&&this.lastOpenedItem!==e&&this.collapseItem(this.lastOpenedItem),this.toggleItem(e),this.lastOpenedItem="true"===this.HEADER(e).getAttribute("aria-expanded")?e:null}},{key:"scrollToItemHeader",value:function(e){var t=this;this.options.scrollToHeading&&setTimeout((function(){t.HEADER(e).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}),this.options.showDuration)}},{key:"toggleItem",value:function(e){"true"===this.HEADER(e).getAttribute("aria-expanded")?this.collapseItem(e):this.expandItem(e)}},{key:"flipIcon",value:function(e){var t=this.HEADER(e).querySelector(".fr-accordion__icon");t&&(t.style.transition="transform ".concat(this.options.showDuration,"ms ease-in-out"),t.classList.toggle("fr-accordion__icon--flipped"))}},{key:"handleFirstItemOpened",value:function(){this.options.firstItemOpened&&(this.expandItem(this.accordionItems[0],!0),this.lastOpenedItem=this.accordionItems[0])}},{key:"handleAllItemsExpanded",value:function(){var e=this;this.options.allItemsExpanded&&this.ITEMS((function(t){return e.expandItem(t,!0)}))}},{key:"handleExpandedClass",value:function(){var e=this;this.options.expandedClass&&this.ITEMS((function(t){t.classList.contains("fr-accordion__item--expanded")&&e.expandItem(t)}))}},{key:"handleScrollToHash",value:function(){var e=this;this.options.scrollToHash&&(document.addEventListener("click",(function(t){var n=t.target.closest('a[href^="#"]');if(n){var i=e.element.querySelector(n.hash);if(null!=i&&i.classList.contains("fr-accordion__header")){var o=i.closest(".fr-accordion__item");o&&(t.preventDefault(),e.scrollToItemAndExpand(o),history.pushState(null,"",n.hash))}}})),window.addEventListener("popstate",(function(t){if(location.hash){var n=e.element.querySelector(location.hash);if(null==n||!n.classList.contains("fr-accordion__header"))return;var i=n.closest(".fr-accordion__item");i&&e.scrollToItemAndExpand(i)}})))}},{key:"handleInitialHash",value:function(){var e=this;if(!this.initialHashHandled){var t=location.hash,n=this.element.querySelector(t);if(null!=n&&n.classList.contains("fr-accordion__header")){var i=n.closest(".fr-accordion__item");i&&("complete"===document.readyState?this.scrollToInitialHash(i):window.addEventListener("load",(function(){return e.scrollToInitialHash(i)})),this.initialHashHandled=!0)}}}},{key:"scrollToInitialHash",value:function(e){var t=this;this.options.closePreviousItem&&this.ITEMS((function(n){n!==e&&"true"===t.HEADER(n).getAttribute("aria-expanded")&&t.collapseItem(n)})),this.expandItem(e),this.lastOpenedItem=e,setTimeout((function(){var n=t.HEADER(e),i=parseInt(t.options.scrollOffset)||1,o=n.getBoundingClientRect().top+window.scrollY-i;window.scrollTo({top:Math.max(0,o),behavior:"instant"})}),this.options.showDuration)}},{key:"scrollToItemAndExpand",value:function(e){var t=this;this.options.closePreviousItem&&(this.options.allItemsExpanded?this.ITEMS((function(n){n!==e&&t.collapseItem(n)})):this.lastOpenedItem&&this.lastOpenedItem!==e&&this.collapseItem(this.lastOpenedItem)),this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.expandItem(e),this.lastOpenedItem=e,requestAnimationFrame((function(){var n=t.HEADER(e),i=parseInt(t.options.scrollOffset)||1,o=n.getBoundingClientRect().top+window.scrollY-i;window.scrollTo({top:Math.max(0,o),behavior:"smooth"})}))}},{key:"expandItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.BODY(e),i=this.HEADER(e);if("true"!==i.getAttribute("aria-expanded")){if(n.style.height=n.scrollHeight+"px",i.setAttribute("aria-expanded","true"),this.options.scrollToHash&&i.id&&!t){var o="".concat(window.location.pathname).concat(window.location.search,"#").concat(i.id);history.replaceState(null,"",o)}var r=new CustomEvent("accordionItemExpanded",{detail:{item:e}});this.element.dispatchEvent(r),this.flipIcon(e),this.updateFocusableTabIndex(e,!0)}}},{key:"collapseItem",value:function(e){var t=this.BODY(e),n=this.HEADER(e);if("false"!==n.getAttribute("aria-expanded")){t.style.height=t.offsetHeight+"px",setTimeout((function(){t.style.height=0}),0),n.setAttribute("aria-expanded","false"),this.options.scrollToHash&&n.id&&location.hash==="#".concat(n.id)&&history.replaceState(null,"",window.location.pathname+window.location.search);var i=new CustomEvent("accordionItemCollapsed",{detail:{item:e}});this.element.dispatchEvent(i),this.flipIcon(e),this.updateFocusableTabIndex(e,!1)}}},{key:"handleShowDuration",value:function(){var e=this;this.options.showDuration&&this.ITEMS((function(t){e.BODY(t).style.transitionDuration=e.options.showDuration+"ms",e.HEADER(t).style.transitionDuration=e.options.showDuration+"ms",e.HEADER(t).querySelector(".fr-accordion__title").style.transitionDuration=e.options.showDuration+"ms"}))}},{key:"addTabindex",value:function(){var e=this;this.ITEMS((function(t){e.HEADER(t).setAttribute("tabindex",0)}))}},{key:"addIdToBody",value:function(){var e=this;this.ITEMS((function(t){e.BODY(t).id||(e.BODY(t).id="fr-accordion__body-"+Math.random().toString(36).substr(2,9))}))}},{key:"addIdToHeader",value:function(){var e=this;this.ITEMS((function(t){var n=e.HEADER(t);n.id||(n.id=e.generateUniqueId(t))}))}},{key:"addAriaControls",value:function(){var e=this;this.ITEMS((function(t){e.HEADER(t).setAttribute("aria-controls",e.BODY(t).id)}))}},{key:"addAriaLabelledBy",value:function(){var e=this;this.ITEMS((function(t){e.BODY(t).setAttribute("aria-labelledby",e.HEADER(t).id)}))}},{key:"addRoleRegion",value:function(){var e=this;this.ITEMS((function(t){e.BODY(t).setAttribute("role","region")}))}},{key:"addRoleButton",value:function(){var e=this;this.ITEMS((function(t){e.HEADER(t).setAttribute("role","button")}))}},{key:"addFaqSchema",value:function(){var e=this;if(this.options.faqSchema){var t=[];this.ITEMS((function(n){var i=e.HEADER(n).textContent.trim(),o=e.BODY(n).textContent.trim();t.push({"@type":"Question",name:i,acceptedAnswer:{"@type":"Answer",text:o}})}));var n={"@context":"https://schema.org","@type":"FAQPage",mainEntity:t},i=document.createElement("script");i.type="application/ld+json",i.innerHTML=JSON.stringify(n),document.head.appendChild(i)}}},{key:"validateStructure",value:function(){if(0===this.element.children.length)return console.warn("The fr-accordion has no children.",this.element),!1;var e,t={UL:function(e){return"LI"===e.tagName||"STYLE"===e.tagName||"DIV"===e.tagName&&e.classList.contains("brx-query-trail")},OL:function(e){return"LI"===e.tagName||"STYLE"===e.tagName||"DIV"===e.tagName&&e.classList.contains("brx-query-trail")}},n=_createForOfIteratorHelper(this.element.children);try{for(n.s();!(e=n.n()).done;){var i=e.value;if("STYLE"===i.tagName||i.classList.contains("brxe-pagination")||Array.from(i.classList).some((function(e){return e.startsWith("brxe-filter-")})))console.log("found wpgb or bricks element, continuing",i);else{i.classList.contains("fr-accordion__item")||i.classList.add("fr-accordion__item");try{this.HEADER(i),this.BODY(i)}catch(e){return console.error(e.message,i),!1}if(i.children.length>2)return console.warn("Remove extra children elements from accordion item:",i),!1;if(i.children.length<2&&i.children.length>0)return console.warn("Add a header and a body to accordion item:",i),!1;"UL"!==this.element.tagName&&"OL"!==this.element.tagName||t[this.element.tagName](i)||console.warn('Direct child of the "ul" or "ol" element should have a tag of "li" instead of "'.concat(i.tagName,'"'),i)}}}catch(e){n.e(e)}finally{n.f()}return!0}},{key:"removePlaceholderChild",value:function(){this.element.querySelectorAll(".brx-nestable-children-placeholder")&&this.element.querySelectorAll(".brx-nestable-children-placeholder").forEach((function(e){e.remove()}))}},{key:"updateFocusableTabIndex",value:function(e,t){e.querySelectorAll('a[href], button, textarea, input[type="text"], input[type="radio"], input[type="checkbox"], select').forEach((function(e){e.setAttribute("tabindex",t?"0":"-1")}))}},{key:"hasCurrentPageLink",value:function(e){return this.BODY(e).querySelector('a[aria-current="page"]')}}],[{key:"getAccordionInstance",value:function(e){return accordionInstances.get(e)}}])}();function accordion_script(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(window.Frames=window.Frames||{},window.Frames.AccordionInstance=Accordion.getAccordionInstance,e){if(!e.dataset.frAccordionOptions)return void console.warn("Options not provided for the following fr-accordion element:",e);var t=JSON.parse(e.dataset.frAccordionOptions);new Accordion(e,t)}else getAccordions().forEach((function(e){if(e.dataset.frAccordionOptions){var t=JSON.parse(e.dataset.frAccordionOptions);new Accordion(e,t)}else console.warn("Options not provided for the following fr-accordion element:",e)}));document.querySelector(".brx-body.iframe.mounted")&&document.querySelectorAll(".fr-accordion").forEach((function(e){Array.from(e.children).forEach((function(e){var t=e.children[0],n=e.children[1];t.addEventListener("click",(function(){n.style.height="auto"===n.style.height?"0px":"auto",t.setAttribute("aria-expanded","true"===t.getAttribute("aria-expanded")?"false":"true")}))}))}))}function wpgb_accordion_script(){window.WP_Grid_Builder&&WP_Grid_Builder.on("init",(function(e){console.dir(e),console.log("console logging WPGB:",e),e.facets.on("appended",(function(e){var t=new Set;e.forEach((function(e){var n=e.closest(".fr-accordion.wpgb-enabled");n&&t.add(n)})),t.forEach((function(e){window.Frames.AccordionInstance(e)&&accordion_script(e)}))}))}))}function runAccordionScriptsOnBricksFilters(){if("function"==typeof window.bricksFilters){var e=bricksFiltersFn.run;bricksFiltersFn.run=function(){e.apply(),document.querySelectorAll(".fr-accordion").forEach((function(e){clearEventListeners(e),accordion_script(e)}))}}}function clearEventListeners(e){bricksIsFrontend&&e.querySelectorAll(".fr-accordion__header").forEach((function(e){var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)}))}document.addEventListener("DOMContentLoaded",(function(e){console.log("New Accordion script loaded"),bricksIsFrontend&&accordion_script(),bricksIsFrontend&&wpgb_accordion_script(),bricksIsFrontend&&runAccordionScriptsOnBricksFilters()}));